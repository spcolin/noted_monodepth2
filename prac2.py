from layers import *
import torch

T=torch.tensor([[ 1.0000e+00, -4.4686e-04,  4.8228e-04,  4.4970e-04],
        [ 4.4647e-04,  1.0000e+00,  8.1792e-04, -4.0195e-04],
        [-4.8263e-04, -8.1771e-04,  1.0000e+00, -7.3688e-04],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  1.0000e+00]])

K=torch.tensor(([[371.2,0,320,0],
                 [0,368.64,96,0],
                 [0,0,1,0],
                 [0,0,0,1]]))

p=torch.tensor([[-0.0104],[0.0021],[0.1939],[1.0000]])

P=torch.matmul(K,T)

p2=torch.matmul(P,p)
# print(T.shape)

print(P)


# [[ 3.7105e+02, -4.2754e-01,  3.2018e+02, -6.8873e-02],
#         [ 1.1825e-01,  3.6856e+02,  9.6302e+01, -2.1892e-01],
#         [-4.8263e-04, -8.1771e-04,  1.0000e+00, -7.3688e-04],
        # [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  1.0000e+00]]



